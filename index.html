<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Калькулятор фолиантов</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #2c3e50;
            color: white;
            border-radius: 8px;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .branch-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 30px;
            justify-content: center;
        }
        
        .branch-btn {
            padding: 12px 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
        }
        
        .branch-btn:hover {
            background-color: #2980b9;
        }
        
        .branch-btn.active {
            background-color: #e74c3c;
        }
        
        .research-section {
            display: none;
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .research-section.active {
            display: block;
        }
        
        .research-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }
        
        .research-item:last-child {
            border-bottom: none;
        }
        
        .research-name {
            flex: 1;
            font-weight: 500;
        }
        
        .progress-input {
            width: 80px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
        }
        
        .remaining {
            width: 100px;
            text-align: right;
            font-weight: bold;
            color: #e74c3c;
        }
        
        .total-remaining {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            background-color: #ecf0f1;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .section-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
            color: #2c3e50;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Калькулятор фолиантов</h1>
            <p>Битва фамильяров</p>
        </header>
        
        <div class="branch-selector">
            <button class="branch-btn active" data-branch="familiars">Битва фамильяров</button>
            <button class="branch-btn" data-branch="sigils">Сигилы</button>
            <button class="branch-btn" data-branch="wonders">Битвы за чудеса</button>
            <button class="branch-btn" data-branch="ammunition">Амуниция</button>
            <button class="branch-btn" data-branch="wonders-upgrade">Улучшение битв за чудеса</button>
            <button class="branch-btn" data-branch="counters">Контртипы</button>
        </div>
        
        <div id="familiars" class="research-section active">
            <h2 class="section-title">Битва фамильяров</h2>
        </div>
        
        <div id="sigils" class="research-section">
            <h2 class="section-title">Сигилы</h2>
        </div>
        
        <div id="wonders" class="research-section">
            <h2 class="section-title">Битвы за чудеса</h2>
        </div>
        
        <div id="ammunition" class="research-section">
            <h2 class="section-title">Амуниция</h2>
        </div>
        
        <div id="wonders-upgrade" class="research-section">
            <h2 class="section-title">Улучшение битв за чудеса</h2>
        </div>
        
        <div id="counters" class="research-section">
            <h2 class="section-title">Контртипы</h2>
        </div>
        
        <div class="total-remaining">
            Всего нужно фолиантов: <span id="total-amount">0</span>
        </div>
    </div>

    <script>
        const researchData = {
            "familiars": [
                { name: "Боевой слот фамильяра I", costs: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] },
                { name: "Скорость создания пактов III", costs: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] },
                { name: "Приручение III", costs: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] },
                { name: "Фамильярность Атк пехоты I", costs: [0, 0, 0, 0, 0, 0, 0, 40, 50, 63] },
                { name: "Фамильярность Атк стрелков I", costs: [0, 0, 0, 0, 0, 0, 0, 40, 50, 63] },
                { name: "Фамильярность Атк кавалерии I", costs: [0, 0, 0, 0, 0, 0, 0, 40, 50, 63] },
                { name: "Боевой слот фамильяра II", costs: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] },
                { name: "Фамильярность Оз пехоты I", costs: [0, 0, 0, 0, 0, 0, 0, 53, 66, 84] },
                { name: "Фамильярность Оз стрелков I", costs: [0, 0, 0, 0, 0, 0, 0, 53, 66, 84] },
                { name: "Фамильярность Оз кавалерии I", costs: [0, 0, 0, 0, 0, 0, 0, 53, 66, 84] },
                { name: "Фамильярность Защ пехоты I", costs: [0, 0, 0, 0, 0, 0, 0, 80, 99, 125] },
                { name: "Фамильярность Защ стрелков I", costs: [0, 0, 0, 0, 0, 0, 0, 80, 99, 125] },
                { name: "Фамильярность Защ кавалерии I", costs: [0, 0, 0, 0, 0, 0, 0, 80, 99, 125] },
                { name: "Боевой слот фамильяра III", costs: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] },
                { name: "Фамильярность Защ пехоты II", costs: [5, 11, 18, 26, 34, 46, 62, 81, 100, 127] },
                { name: "Фамильярность Защ стрелков II", costs: [5, 11, 18, 26, 34, 46, 62, 81, 100, 127] },
                { name: "Фамильярность Защ кавалерии II", costs: [5, 11, 18, 26, 34, 46, 62, 81, 100, 127] },
                { name: "Фамильярность Оз пехоты II", costs: [7, 17, 27, 38, 50, 70, 93, 121, 150, 190] },
                { name: "Фамильярность Оз стрелков II", costs: [7, 17, 27, 38, 50, 70, 93, 121, 150, 190] },
                { name: "Фамильярность Оз кавалерии II", costs: [7, 17, 27, 38, 50, 70, 93, 121, 150, 190] },
                { name: "Фамильярность Атк пехоты II", costs: [11, 25, 39, 56, 73, 100, 137, 177, 220, 278] },
                { name: "Фамильярность Атк стрелков II", costs: [11, 25, 39, 56, 73, 100, 137, 177, 220, 278] },
                { name: "Фамильярность Атк кавалерии II", costs: [11, 25, 39, 56, 73, 100, 137, 177, 220, 278] },
                { name: "Боевой слот фамильяра IV", costs: [500, 0, 0, 0, 0, 0, 0, 0, 0, 0] },
                { name: "Скорость создания камней навыка II", costs: [14, 28, 46, 66, 86, 119, 161, 209, 260, 328] },
                { name: "Время приручения II", costs: [14, 28, 46, 66, 86, 119, 161, 209, 260, 328] },
                { name: "Защ фамильяра", costs: [15, 36, 58, 81, 105, 146, 199, 257, 319, 404] },
                { name: "Оз фамильяра", costs: [15, 36, 58, 81, 105, 146, 199, 257, 319, 404] },
                { name: "Атк фамильяра", costs: [15, 36, 58, 81, 105, 146, 199, 257, 319, 404] },
                { name: "Боевой слот фамильяра V", costs: [940, 0, 0, 0, 0, 0, 0, 0, 0, 0] }
            ],
            "sigils": [
                { name: "Добыча ресурсов III", costs: [1, 2, 4, 6, 8, 10, 14, 18, 22, 27] },
                { name: "Скорость ковки", costs: [2, 3, 4, 6, 8, 11, 14, 19, 24, 29] },
                { name: "Силовая тренировка III", costs: [2, 3, 5, 7, 9, 12, 16, 21, 26, 33] },
                { name: "Эффективная ковка", costs: [2, 3, 4, 6, 8, 11, 14, 19, 24, 29] },
                { name: "Продовольственный марш II", costs: [2, 3, 5, 7, 9, 12, 16, 21, 26, 33] },
                { name: "Лидерство Атк пехоты", costs: [3, 7, 11, 15, 19, 26, 36, 46, 57, 72] },
                { name: "Лидерство Атк осадных орудий", costs: [3, 7, 11, 15, 19, 26, 36, 46, 57, 72] },
                { name: "Лидерство Атк стрелков", costs: [3, 7, 11, 15, 19, 26, 36, 46, 57, 72] },
                { name: "Лидерство Атк кавалерии", costs: [3, 7, 11, 15, 19, 26, 36, 46, 57, 72] },
                { name: "Лидерство Оз пехоты", costs: [3, 7, 12, 17, 22, 29, 40, 52, 64, 81] },
                { name: "Лидерство Оз осадных орудий", costs: [3, 7, 12, 17, 22, 29, 40, 52, 64, 81] },
                { name: "Лидерство Оз стрелков", costs: [3, 7, 12, 17, 22, 29, 40, 52, 64, 81] },
                { name: "Лидерство Оз кавалерии", costs: [3, 7, 12, 17, 22, 29, 40, 52, 64, 81] },
                { name: "Лидерство Защ пехоты", costs: [4, 9, 14, 20, 26, 36, 49, 63, 78, 99] },
                { name: "Лидерство Защ осадных орудий", costs: [4, 9, 14, 20, 26, 36, 49, 63, 78, 99] },
                { name: "Лидерство Защ стрелков", costs: [4, 9, 14, 20, 26, 36, 49, 63, 78, 99] },
                { name: "Лидерство Защ кавалерии", costs: [4, 9, 14, 20, 26, 36, 49, 63, 78, 99] },
                { name: "Сигил для шлема", costs: [96, 0, 0, 0, 0, 0, 0, 0, 0, 0] },
                { name: "Яростная защита пехота", costs: [8, 18, 29, 42, 55, 75, 102, 132, 164, 207] },
                { name: "Яростная защита осадные орудия", costs: [8, 18, 29, 42, 55, 75, 102, 132, 164, 207] },
                { name: "Яростная защита стрелки", costs: [8, 18, 29, 42, 55, 75, 102, 132, 164, 207] },
                { name: "Яростная защита кавалерия", costs: [8, 18, 29, 42, 55, 75, 102, 132, 164, 207] },
                { name: "Сигил для брони", costs: [160, 0, 0, 0, 0, 0, 0, 0, 0, 0] },
                { name: "Сигил для поножей", costs: [160, 0, 0, 0, 0, 0, 0, 0, 0, 0] },
                { name: "Яростная прочность пехота", costs: [10, 23, 36, 51, 66, 91, 125, 161, 200, 253] },
                { name: "Яростная прочность осадные орудия", costs: [10, 23, 36, 51, 66, 91, 125, 161, 200, 253] },
                { name: "Яростная прочность стрелки", costs: [10, 23, 36, 51, 66, 91, 125, 161, 200, 253] },
                { name: "Яростная прочность кавалерия", costs: [10, 23, 36, 51, 66, 91, 125, 161, 200, 253] },
                { name: "Сигил для 1 руки", costs: [256, 0, 0, 0, 0, 0, 0, 0, 0, 0] },
                { name: "Сигил для 2 руки", costs: [256, 0, 0, 0, 0, 0, 0, 0, 0, 0] },
                { name: "Яростное нападение пехота", costs: [15, 35, 57, 81, 105, 145, 198, 256, 318, 403] },
                { name: "Яростное нападение осадные орудия", costs: [15, 35, 57, 81, 105, 145, 198, 256, 318, 403] },
                { name: "Яростное нападение стрелки", costs: [15, 35, 57, 81, 105, 145, 198, 256, 318, 403] },
                { name: "Яростное нападение кавалерия", costs: [15, 35, 57, 81, 105, 145, 198, 256, 318, 403] },
                { name: "Сигил для украшения", costs: [672, 0, 0, 0, 0, 0, 0, 0, 0, 0] }
            ],
            "wonders": [
                { name: "Чудесный марш", costs: [2, 4, 7, 10, 14, 18, 24, 31, 38, 48] },
                { name: "Сбор самоцветов II", costs: [3, 6, 9, 12, 15, 21, 29, 37, 46, 58] },
                { name: "Продовольственный марш III", costs: [3, 6, 9, 12, 15, 21, 29, 37, 46, 58] },
                { name: "Расширенное снабжение II", costs: [3, 6, 10, 14, 19, 25, 33, 43, 53, 67] },
                { name: "Скорое снабжение II", costs: [3, 6, 10, 14, 19, 25, 33, 43, 53, 67] },
                { name: "Атака пехоты (чудо) I", costs: [4, 9, 14, 19, 26, 35, 47, 61, 76, 96] },
                { name: "Атака стрелков (чудо) I", costs: [4, 9, 14, 19, 26, 35, 47, 61, 76, 96] },
                { name: "Атака кавалерии (чудо) I", costs: [4, 9, 14, 19, 26, 35, 47, 61, 76, 96] },
                { name: "Здоровье пехоты (чудо) I", costs: [6, 13, 21, 29, 38, 52, 71, 92, 114, 144] },
                { name: "Здоровье стрелков (чудо) I", costs: [6, 13, 21, 29, 38, 52, 71, 92, 114, 144] },
                { name: "Здоровье кавалерии (чудо) I", costs: [6, 13, 21, 29, 38, 52, 71, 92, 114, 144] },
                { name: "Защита пехоты (чудо) I", costs: [7, 17, 27, 39, 51, 69, 94, 122, 152, 192] },
                { name: "Защита стрелков (чудо) I", costs: [7, 17, 27, 39, 51, 69, 94, 122, 152, 192] },
                { name: "Защита кавалерии (чудо) I", costs: [7, 17, 27, 39, 51, 69, 94, 122, 152, 192] },
                { name: "Тренировка IV", costs: [10, 23, 38, 53, 69, 95, 130, 168, 208, 264] },
                { name: "Расширение больниц II", costs: [10, 23, 38, 53, 69, 95, 130, 168, 208, 264] },
                { name: "Групповой сбор на чудо I", costs: [14, 34, 54, 77, 101, 138, 188, 244, 303, 383] },
                { name: "Защита пехоты (чудо) II", costs: [10, 23, 38, 54, 71, 98, 133, 172, 214, 270] },
                { name: "Защита стрелков (чудо) II", costs: [10, 23, 38, 54, 71, 98, 133, 172, 214, 270] },
                { name: "Защита кавалерии (чудо) II", costs: [10, 23, 38, 54, 71, 98, 133, 172, 214, 270] },
                { name: "Здоровье пехоты (чудо) II", costs: [12, 28, 46, 65, 85, 117, 159, 206, 256, 324] },
                { name: "Здоровье стрелков (чудо) II", costs: [12, 28, 46, 65, 85, 117, 159, 206, 256, 324] },
                { name: "Здоровье кавалерии (чудо) II", costs: [12, 28, 46, 65, 85, 117, 159, 206, 256, 324] },
                { name: "Атака пехоты (чудо) II", costs: [14, 32, 53, 76, 99, 136, 186, 241, 299, 378] },
                { name: "Атака стрелков (чудо) II", costs: [14, 32, 53, 76, 99, 136, 186, 241, 299, 378] },
                { name: "Атака кавалерии (чудо) II", costs: [14, 32, 53, 76, 99, 136, 186, 241, 299, 378] },
                { name: "Групповой сбор на чудо II", costs: [17, 40, 65, 92, 120, 166, 226, 292, 363, 459] }
            ],
            "ammunition": [
                { name: "Быстрые маневры III", costs: [1, 1, 2, 2, 3, 4, 5, 6, 8, 10] },
                { name: "Продовольственный марш IV", costs: [1, 2, 3, 5, 7, 9, 12, 15, 19, 24] },
                { name: "Скорое снабжение III", costs: [1, 2, 3, 5, 7, 9, 12, 15, 19, 24] },
                { name: "Центральное командование II", costs: [13, 35, 63, 113, 180, 0, 0, 0, 0, 0] },
                { name: "Полевая сортировка II", costs: [2, 4, 6, 8, 10, 14, 19, 25, 31, 39] },
                { name: "Расширенное снабжение III", costs: [2, 4, 6, 8, 10, 14, 19, 25, 31, 39] },
                { name: "Расширение больниц III", costs: [3, 5, 8, 11, 15, 21, 29, 37, 46, 58] },
                { name: "Расширение казарм II", costs: [3, 5, 8, 11, 15, 21, 29, 37, 46, 58] },
                { name: "Лунный цех", costs: [30, 0, 0, 0, 0, 0, 0, 0, 0, 0] },
                { name: "Скорость создания I", costs: [5, 10, 16, 23, 30, 42, 57, 73, 91, 115] },
                { name: "Сбор лунита", costs: [5, 10, 16, 23, 30, 42, 57, 73, 91, 115] },
                { name: "Хранилище лунита", costs: [5, 10, 16, 23, 30, 42, 57, 73, 91, 115] },
                { name: "Защита пехоты II", costs: [7, 14, 24, 34, 44, 60, 82, 107, 132, 167] },
                { name: "Стойкость осадных орудий II", costs: [7, 14, 24, 34, 44, 60, 82, 107, 132, 167] },
                { name: "Защита стрелков II", costs: [7, 14, 24, 34, 44, 60, 82, 107, 132, 167] },
                { name: "Защита кавалерии II", costs: [7, 14, 24, 34, 44, 60, 82, 107, 132, 167] },
                { name: "Здоровье пехоты II", costs: [9, 20, 34, 48, 62, 86, 117, 152, 189, 238] },
                { name: "Прочность осадных орудий II", costs: [9, 20, 34, 48, 62, 86, 117, 152, 189, 238] },
                { name: "Здоровье стрелков II", costs: [9, 20, 34, 48, 62, 86, 117, 152, 189, 238] },
                { name: "Здоровье кавалерии II", costs: [9, 20, 34, 48, 62, 86, 117, 152, 189, 238] },
                { name: "Наступление пехоты II", costs: [13, 28, 47, 67, 87, 120, 164, 213, 264, 334] },
                { name: "Атака осадных орудий II", costs: [13, 28, 47, 67, 87, 120, 164, 213, 264, 334] },
                { name: "Наступление стрелков II", costs: [13, 28, 47, 67, 87, 120, 164, 213, 264, 334] },
                { name: "Наступление кавалерии II", costs: [13, 28, 47, 67, 87, 120, 164, 213, 264, 334] },
                { name: "Скорость создания II", costs: [14, 32, 54, 77, 100, 138, 187, 243, 301, 381] },
                { name: "Объем изготовления", costs: [14, 32, 54, 77, 100, 138, 187, 243, 301, 381] },
                { name: "Светящийся страж", costs: [593, 0, 0, 0, 0, 0, 0, 0, 0, 0] },
                { name: "Светящийся мститель", costs: [593, 0, 0, 0, 0, 0, 0, 0, 0, 0] },
                { name: "Светящийся стрелок", costs: [593, 0, 0, 0, 0, 0, 0, 0, 0, 0] },
                { name: "Светящийся наездник", costs: [593, 0, 0, 0, 0, 0, 0, 0, 0, 0] }
            ],
            "wonders-upgrade": [
                { name: "Участник сбора на чудо", costs: [6, 12, 19, 28, 37, 50, 68, 88, 109, 138] },
                { name: "Лидерство Атк пехоты II", costs: [7, 15, 25, 36, 48, 65, 88, 114, 142, 180] },
                { name: "Лидерство Атк осадных орудий II", costs: [7, 15, 25, 36, 48, 65, 88, 114, 142, 180] },
                { name: "Лидерство Атк стрелков II", costs: [7, 15, 25, 36, 48, 65, 88, 114, 142, 180] },
                { name: "Лидерство Атк кавалерии II", costs: [7, 15, 25, 36, 48, 65, 88, 114, 142, 180] },
                { name: "Лидерство Защ пехоты II", costs: [9, 20, 32, 46, 63, 85, 115, 150, 186, 235] },
                { name: "Лидерство Защ осадных орудий II", costs: [9, 20, 32, 46, 63, 85, 115, 150, 186, 235] },
                { name: "Лидерство Защ стрелков II", costs: [9, 20, 32, 46, 63, 85, 115, 150, 186, 235] },
                { name: "Лидерство Защ кавалерии II", costs: [9, 20, 32, 46, 63, 85, 115, 150, 186, 235] },
                { name: "Лидерство Оз пехоты II", costs: [12, 25, 42, 60, 82, 110, 149, 193, 240, 304] },
                { name: "Лидерство Оз осадных орудий II", costs: [12, 25, 42, 60, 82, 110, 149, 193, 240, 304] },
                { name: "Лидерство Оз стрелков II", costs: [12, 25, 42, 60, 82, 110, 149, 193, 240, 304] },
                { name: "Лидерство Оз кавалерии II", costs: [12, 25, 42, 60, 82, 110, 149, 193, 240, 304] },
                { name: "Чудесный марш II", costs: [13, 28, 46, 66, 89, 120, 163, 211, 262, 332] },
                { name: "Прочность пехоты (чудо) III", costs: [16, 34, 57, 82, 111, 149, 204, 264, 327, 414] },
                { name: "Прочность стрелков (чудо) III", costs: [16, 34, 57, 82, 111, 149, 204, 264, 327, 414] },
                { name: "Прочность кавалерии (чудо) III", costs: [16, 34, 57, 82, 111, 149, 204, 264, 327, 414] },
                { name: "Наступление пехоты (чудо) III", costs: [19, 42, 70, 100, 136, 184, 250, 324, 402, 509] },
                { name: "Наступление стрелков (чудо) III", costs: [19, 42, 70, 100, 136, 184, 250, 324, 402, 509] },
                { name: "Наступление кавалерии (чудо) III", costs: [19, 42, 70, 100, 136, 184, 250, 324, 402, 509] },
                { name: "Защита пехоты (чудо) III", costs: [23, 51, 84, 121, 165, 222, 302, 392, 486, 615] },
                { name: "Защита стрелков (чудо) III", costs: [23, 51, 84, 121, 165, 222, 302, 392, 486, 615] },
                { name: "Защита кавалерии (чудо) III", costs: [23, 51, 84, 121, 165, 222, 302, 392, 486, 615] },
                { name: "Проклятие Защ пехоты (чудо)", costs: [32, 43, 55, 74, 106, 158, 264, 474, 885, 1580] },
                { name: "Проклятие Защ стрелков (чудо)", costs: [32, 43, 55, 74, 106, 158, 264, 474, 885, 1580] },
                { name: "Проклятие Защ кавалерии (чудо)", costs: [32, 43, 55, 74, 106, 158, 264, 474, 885, 1580] },
                { name: "Проклятие Оз пехоты (чудо)", costs: [42, 55, 72, 96, 137, 206, 343, 617, 1150, 2054] },
                { name: "Проклятие Оз стрелков (чудо)", costs: [42, 55, 72, 96, 137, 206, 343, 617, 1150, 2054] },
                { name: "Проклятие Оз кавалерии (чудо)", costs: [42, 55, 72, 96, 137, 206, 343, 617, 1150, 2054] },
                { name: "Проклятие Атк пехоты (чудо)", costs: [54, 72, 94, 126, 180, 269, 448, 806, 1504, 2686] },
                { name: "Проклятие Атк стрелков (чудо)", costs: [54, 72, 94, 126, 180, 269, 448, 806, 1504, 2686] },
                { name: "Проклятие Атк кавалерии (чудо)", costs: [54, 72, 94, 126, 180, 269, 448, 806, 1504, 2686] }
            ],
            "counters": [
                { name: "Усиление пехоты против стрелков", costs: [17, 39, 64, 92, 125, 169, 230, 298, 370, 468] },
                { name: "Усиление стрелков против кавалерии", costs: [17, 39, 64, 92, 125, 169, 230, 298, 370, 468] },
                { name: "Усиление кавалерии против пехоты", costs: [17, 39, 64, 92, 125, 169, 230, 298, 370, 468] }
            ]
        };
        function initApp() {
            for (const branch in researchData) {
                const section = document.getElementById(branch);
                if (section) {
                    researchData[branch].forEach((research, index) => {
                        const researchItem = document.createElement('div');
                        researchItem.className = 'research-item';
                        researchItem.innerHTML = 
                            `<div class="research-name">${research.name}</div>
                            <input type="number" class="progress-input" min="0" max="10" value="0" data-branch="${branch}" data-index="${index}">
                            <div class="remaining" data-branch="${branch}" data-index="${index}">0</div>`;
                        section.appendChild(researchItem);
                    });
                }
            }

            
            document.querySelectorAll('.branch-btn').forEach(button => {
                button.addEventListener('click', function() {                    
                    document.querySelectorAll('.branch-btn').forEach(btn => btn.classList.remove('active'));
                    document.querySelectorAll('.research-section').forEach(section => section.classList.remove('active'));                       
                    this.classList.add('active');
                    const branchId = this.getAttribute('data-branch');
                    document.getElementById(branchId).classList.add('active');                  
                    calculateTotal();
                });
            });

            document.addEventListener('input', function(e) {
                if (e.target.classList.contains('progress-input')) {
                    const branch = e.target.getAttribute('data-branch');
                    const index = e.target.getAttribute('data-index');
                    const progress = parseInt(e.target.value) || 0;
                    
                    if (progress < 0) e.target.value = 0;
                    if (progress > 10) e.target.value = 10;
                    
                    
                    calculateRemaining(branch, index);
                    
                    
                    calculateTotal();
                }
            });

            
            for (const branch in researchData) {
                researchData[branch].forEach((research, index) => {
                    calculateRemaining(branch, index);
                });
            }
            
            
            calculateTotal();
        }

        
        function calculateRemaining(branch, index) {
            const research = researchData[branch][index];
            const progressInput = document.querySelector(`.progress-input[data-branch="${branch}"][data-index="${index}"]`);
            const remainingElement = document.querySelector(`.remaining[data-branch="${branch}"][data-index="${index}"]`);
            
            const progress = parseInt(progressInput.value) || 0;
                      
            let remaining = 0;
            for (let i = progress; i < 10; i++) {
                remaining += research.costs[i];
            }
            
            remainingElement.textContent = remaining;
            return remaining;
        }
      
        function calculateTotal() {
            let total = 0;
            
            document.querySelectorAll('.research-section.active .research-item').forEach(item => {
                const remainingElement = item.querySelector('.remaining');
                total += parseInt(remainingElement.textContent) || 0;
            });
            
            document.getElementById('total-amount').textContent = total;
        }

        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>