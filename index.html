<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Калькулятор фолиантов</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        
        body {
            background: #f5f5f5;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 20px;
        }
        
        .branch-selector {
            margin-bottom: 20px;
        }
        
        select {
            width: 100%;
            padding: 10px;
            border: 2px solid #3498db;
            border-radius: 5px;
            font-size: 16px;
            margin-bottom: 10px;
        }
        
        .research-list {
            margin-bottom: 20px;
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
        }
        
        .research-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 5px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        .research-name {
            flex: 1;
            font-size: 14px;
            padding-right: 10px;
        }
        
        .research-input {
            width: 60px;
            padding: 5px;
            border: 1px solid #bdc3c7;
            border-radius: 3px;
            text-align: center;
        }
        
        .research-remaining {
            width: 80px;
            text-align: right;
            font-weight: bold;
            color: #e74c3c;
        }
        
        .total {
            background: #2ecc71;
            color: white;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
            margin-top: 20px;
        }
        
        .total-amount {
            font-size: 24px;
            font-weight: bold;
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Калькулятор фолиантов</h1>
        
        <div class="branch-selector">
            <select id="branchSelect">
                <option value="familiars">Битва фамильяров</option>
                <option value="sigils">Сигилы</option>
                <option value="wonders">Битвы за чудеса</option>
                <option value="ammunition">Амуниция</option>
                <option value="wonder_upgrade">Улучшение битв за чудеса</option>
                <option value="countertypes">Контртипы</option>
            </select>
        </div>
        
        <div class="research-list" id="researchList">
            <!-- Список исследований будет здесь -->
        </div>
        
        <div class="total">
            <div>Всего нужно фолиантов:</div>
            <div class="total-amount" id="totalAmount">0</div>
        </div>
    </div>

    <script>
        // Полные данные всех исследований
        const researchData = {
            familiars: [
                { name: "Боевой слот фамильяра I", costs: [0,0,0,0,0,0,0,0,0,0] },
                { name: "Скорость создания пактов III", costs: [0,0,0,0,0,0,0,0,0,0] },
                { name: "Приручение III", costs: [0,0,0,0,0,0,0,0,0,0] },
                { name: "Фамильярность Атк пехоты I", costs: [0,0,0,0,0,0,0,40,50,63] },
                { name: "Фамильярность Атк стрелков I", costs: [0,0,0,0,0,0,0,40,50,63] },
                { name: "Фамильярность Атк кавалерии I", costs: [0,0,0,0,0,0,0,40,50,63] },
                { name: "Боевой слот фамильяра II", costs: [0,0,0,0,0,0,0,0,0,0] },
                { name: "Фамильярность Оз пехоты I", costs: [0,0,0,0,0,0,0,53,66,84] },
                { name: "Фамильярность Оз стрелков I", costs: [0,0,0,0,0,0,0,53,66,84] },
                { name: "Фамильярность Оз кавалерии I", costs: [0,0,0,0,0,0,0,53,66,84] },
                { name: "Фамильярность Защ пехоты I", costs: [0,0,0,0,0,0,0,80,99,125] },
                { name: "Фамильярность Защ стрелков I", costs: [0,0,0,0,0,0,0,80,99,125] },
                { name: "Фамильярность Защ кавалерии I", costs: [0,0,0,0,0,0,0,80,99,125] },
                { name: "Боевой слот фамильяра III", costs: [0,0,0,0,0,0,0,0,0,0] },
                { name: "Фамильярность Защ пехоты II", costs: [5,11,18,26,34,46,62,81,100,127] },
                { name: "Фамильярность Защ стрелков II", costs: [5,11,18,26,34,46,62,81,100,127] },
                { name: "Фамильярность Защ кавалерии II", costs: [5,11,18,26,34,46,62,81,100,127] },
                { name: "Фамильярность Оз пехоты II", costs: [7,17,27,38,50,70,93,121,150,190] },
                { name: "Фамильярность Оз стрелков II", costs: [7,17,27,38,50,70,93,121,150,190] },
                { name: "Фамильярность Оз кавалерии II", costs: [7,17,27,38,50,70,93,121,150,190] },
                { name: "Фамильярность Атк пехоты II", costs: [11,25,39,56,73,100,137,177,220,278] },
                { name: "Фамильярность Атк стрелков II", costs: [11,25,39,56,73,100,137,177,220,278] },
                { name: "Фамильярность Атк кавалерии II", costs: [11,25,39,56,73,100,137,177,220,278] },
                { name: "Боевой слот фамильяра IV", costs: [500,0,0,0,0,0,0,0,0,0] },
                { name: "Скорость создания камней навыка II", costs: [14,28,46,66,86,119,161,209,260,328] },
                { name: "Время приручения II", costs: [14,28,46,66,86,119,161,209,260,328] },
                { name: "Защ фамильяра", costs: [15,36,58,81,105,146,199,257,319,404] },
                { name: "Оз фамильяра", costs: [15,36,58,81,105,146,199,257,319,404] },
                { name: "Атк фамильяра", costs: [15,36,58,81,105,146,199,257,319,404] },
                { name: "Боевой слот фамильяра V", costs: [940,0,0,0,0,0,0,0,0,0] }
            ],
            sigils: [
                { name: "Добыча ресурсов III", costs: [1,2,4,6,8,10,14,18,22,27] },
                { name: "Скорость ковки", costs: [2,3,4,6,8,11,14,19,24,29] },
                { name: "Силовая тренировка III", costs: [2,3,5,7,9,12,16,21,26,33] },
                { name: "Эффективная ковка", costs: [2,3,4,6,8,11,14,19,24,29] },
                { name: "Продовольственный марш II", costs: [2,3,5,7,9,12,16,21,26,33] },
                { name: "Лидерство Атк пехоты", costs: [3,7,11,15,19,26,36,46,57,72] },
                { name: "Лидерство Атк осадных орудий", costs: [3,7,11,15,19,26,36,46,57,72] },
                { name: "Лидерство Атк стрелков", costs: [3,7,11,15,19,26,36,46,57,72] },
                { name: "Лидерство Атк кавалерии", costs: [3,7,11,15,19,26,36,46,57,72] },
                { name: "Лидерство Оз пехоты", costs: [3,7,12,17,22,29,40,52,64,81] },
                { name: "Лидерство Оз осадных орудий", costs: [3,7,12,17,22,29,40,52,64,81] },
                { name: "Лидерство Оз стрелков", costs: [3,7,12,17,22,29,40,52,64,81] },
                { name: "Лидерство Оз кавалерии", costs: [3,7,12,17,22,29,40,52,64,81] },
                { name: "Лидерство Защ пехоты", costs: [4,9,14,20,26,36,49,63,78,99] },
                { name: "Лидерство Защ осадных орудий", costs: [4,9,14,20,26,36,49,63,78,99] },
                { name: "Лидерство Защ стрелков", costs: [4,9,14,20,26,36,49,63,78,99] },
                { name: "Лидерство Защ кавалерии", costs: [4,9,14,20,26,36,49,63,78,99] },
                { name: "Сигил для шлема", costs: [96,0,0,0,0,0,0,0,0,0] },
                { name: "Яростная защита пехота", costs: [8,18,29,42,55,75,102,132,164,207] },
                { name: "Яростная защита осадные орудия", costs: [8,18,29,42,55,75,102,132,164,207] },
                { name: "Яростная защита стрелки", costs: [8,18,29,42,55,75,102,132,164,207] },
                { name: "Яростная защита кавалерия", costs: [8,18,29,42,55,75,102,132,164,207] },
                { name: "Сигил для брони", costs: [160,0,0,0,0,0,0,0,0,0] },
                { name: "Сигил для поножей", costs: [160,0,0,0,0,0,0,0,0,0] },
                { name: "Яростная прочность пехота", costs: [10,23,36,51,66,91,125,161,200,253] },
                { name: "Яростная прочность осадные орудия", costs: [10,23,36,51,66,91,125,161,200,253] },
                { name: "Яростная прочность стрелки", costs: [10,23,36,51,66,91,125,161,200,253] },
                { name: "Яростная прочность кавалерия", costs: [10,23,36,51,66,91,125,161,200,253] },
                { name: "Сигил для 1 руки", costs: [256,0,0,0,0,0,0,0,0,0] },
                { name: "Сигил для 2 руки", costs: [256,0,0,0,0,0,0,0,0,0] },
                { name: "Яростное нападение пехота", costs: [15,35,57,81,105,145,198,256,318,403] },
                { name: "Яростное нападение осадные орудия", costs: [15,35,57,81,105,145,198,256,318,403] },
                { name: "Яростное нападение стрелки", costs: [15,35,57,81,105,145,198,256,318,403] },
                { name: "Яростное нападение кавалерия", costs: [15,35,57,81,105,145,198,256,318,403] },
                { name: "Сигил для украшения", costs: [672,0,0,0,0,0,0,0,0,0] }
            ],
            wonders: [
                { name: "Чудесный марш", costs: [2,4,7,10,14,18,24,31,38,48] },
                { name: "Сбор самоцветов II", costs: [3,6,9,12,15,21,29,37,46,58] },
                { name: "Продовольственный марш III", costs: [3,6,9,12,15,21,29,37,46,58] },
                { name: "Расширенное снабжение II", costs: [3,6,10,14,19,25,33,43,53,67] },
                { name: "Скорое снабжение II", costs: [3,6,10,14,19,25,33,43,53,67] },
                { name: "Атака пехоты (чудо) I", costs: [4,9,14,19,26,35,47,61,76,96] },
                { name: "Атака стрелков (чудо) I", costs: [4,9,14,19,26,35,47,61,76,96] },
                { name: "Атака кавалерии (чудо) I", costs: [4,9,14,19,26,35,47,61,76,96] },
                { name: "Здоровье пехоты (чудо) I", costs: [6,13,21,29,38,52,71,92,114,144] },
                { name: "Здоровье стрелков (чудо) I", costs: [6,13,21,29,38,52,71,92,114,144] },
                { name: "Здоровье кавалерии (чудо) I", costs: [6,13,21,29,38,52,71,92,114,144] },
                { name: "Защита пехоты (чудо) I", costs: [7,17,27,39,51,69,94,122,152,192] },
                { name: "Защита стрелков (чудо) I", costs: [7,17,27,39,51,69,94,122,152,192] },
                { name: "Защита кавалерии (чудо) I", costs: [7,17,27,39,51,69,94,122,152,192] },
                { name: "Тренировка IV", costs: [10,23,38,53,69,95,130,168,208,264] },
                { name: "Расширение больниц II", costs: [10,23,38,53,69,95,130,168,208,264] },
                { name: "Групповой сбор на чудо I", costs: [14,34,54,77,101,138,188,244,303,383] },
                { name: "Защита пехоты (чудо) II", costs: [10,23,38,54,71,98,133,172,214,270] },
                { name: "Защита стрелков (чудо) II", costs: [10,23,38,54,71,98,133,172,214,270] },
                { name: "Защита кавалерии (чудо) II", costs: [10,23,38,54,71,98,133,172,214,270] },
                { name: "Здоровье пехоты (чудо) II", costs: [12,28,46,65,85,117,159,206,256,324] },
                { name: "Здоровье стрелков (чудо) II", costs: [12,28,46,65,85,117,159,206,256,324] },
                { name: "Здоровье кавалерии (чудо) II", costs: [12,28,46,65,85,117,159,206,256,324] },
                { name: "Атака пехоты (чудо) II", costs: [14,32,53,76,99,136,186,241,299,378] },
                { name: "Атака стрелков (чудо) II", costs: [14,32,53,76,99,136,186,241,299,378] },
                { name: "Атака кавалерии (чудо) II", costs: [14,32,53,76,99,136,186,241,299,378] },
                { name: "Групповой сбор на чудо II", costs: [17,40,65,92,120,166,226,292,363,459] }
            ],
            ammunition: [
                { name: "Быстрые маневры III", costs: [1,1,2,2,3,4,5,6,8,10] },
                { name: "Продовольственный марш IV", costs: [1,2,3,5,7,9,12,15,19,24] },
                { name: "Скорое снабжение III", costs: [1,2,3,5,7,9,12,15,19,24] },
                { name: "Центральное командование II", costs: [13,35,63,113,180,0,0,0,0,0] },
                { name: "Полевая сортировка II", costs: [2,4,6,8,10,14,19,25,31,39] },
                { name: "Расширенное снабжение III", costs: [2,4,6,8,10,14,19,25,31,39] },
                { name: "Расширение больниц III", costs: [3,5,8,11,15,21,29,37,46,58] },
                { name: "Расширение казарм II", costs: [3,5,8,11,15,21,29,37,46,58] },
                { name: "Лунный цех", costs: [30,0,0,0,0,0,0,0,0,0] },
                { name: "Скорость создания I", costs: [5,10,16,23,30,42,57,73,91,115] },
                { name: "Сбор лунита", costs: [5,10,16,23,30,42,57,73,91,115] },
                { name: "Хранилище лунита", costs: [5,10,16,23,30,42,57,73,91,115] },
                { name: "Защита пехоты II", costs: [7,14,24,34,44,60,82,107,132,167] },
                { name: "Стойкость осадных орудий II", costs: [7,14,24,34,44,60,82,107,132,167] },
                { name: "Защита стрелков II", costs: [7,14,24,34,44,60,82,107,132,167] },
                { name: "Защита кавалерии II", costs: [7,14,24,34,44,60,82,107,132,167] },
                { name: "Здоровье пехоты II", costs: [9,20,34,48,62,86,117,152,189,238] },
                { name: "Прочность осадных орудий II", costs: [9,20,34,48,62,86,117,152,189,238] },
                { name: "Здоровье стрелков II", costs: [9,20,34,48,62,86,117,152,189,238] },
                { name: "Здоровье кавалерии II", costs: [9,20,34,48,62,86,117,152,189,238] },
                { name: "Наступление пехоты II", costs: [13,28,47,67,87,120,164,213,264,334] },
                { name: "Атака осадных орудий II", costs: [13,28,47,67,87,120,164,213,264,334] },
                { name: "Наступление стрелков II", costs: [13,28,47,67,87,120,164,213,264,334] },
                { name: "Наступление кавалерии II", costs: [13,28,47,67,87,120,164,213,264,334] },
                { name: "Скорость создания II", costs: [14,32,54,77,100,138,187,243,301,381] },
                { name: "Объем изготовления", costs: [14,32,54,77,100,138,187,243,301,381] },
                { name: "Светящийся страж", costs: [593,0,0,0,0,0,0,0,0,0] },
                { name: "Светящийся мститель", costs: [593,0,0,0,0,0,0,0,0,0] },
                { name: "Светящийся стрелок", costs: [593,0,0,0,0,0,0,0,0,0] },
                { name: "Светящийся наездник", costs: [593,0,0,0,0,0,0,0,0,0] }
            ],
            wonder_upgrade: [
                { name: "Участник сбора на чудо", costs: [6,12,19,28,37,50,68,88,109,138] },
                { name: "Лидерство Атк пехоты II", costs: [7,15,25,36,48,65,88,114,142,180] },
                { name: "Лидерство Атк осадных орудий II", costs: [7,15,25,36,48,65,88,114,142,180] },
                { name: "Лидерство Атк стрелков II", costs: [7,15,25,36,48,65,88,114,142,180] },
                { name: "Лидерство Атк кавалерии II", costs: [7,15,25,36,48,65,88,114,142,180] },
                { name: "Лидерство Защ пехоты II", costs: [9,20,32,46,63,85,115,150,186,235] },
                { name: "Лидерство Защ осадных орудий II", costs: [9,20,32,46,63,85,115,150,186,235] },
                { name: "Лидерство Защ стрелков II", costs: [9,20,32,46,63,85,115,150,186,235] },
                { name: "Лидерство Защ кавалерии II", costs: [9,20,32,46,63,85,115,150,186,235] },
                { name: "Лидерство Оз пехоты II", costs: [12,25,42,60,82,110,149,193,240,304] },
                { name: "Лидерство Оз осадных орудий II", costs: [12,25,42,60,82,110,149,193,240,304] },
                { name: "Лидерство Оз стрелков II", costs: [12,25,42,60,82,110,149,193,240,304] },
                { name: "Лидерство Оз кавалерии II", costs: [12,25,42,60,82,110,149,193,240,304] },
                { name: "Чудесный марш II", costs: [13,28,46,66,89,120,163,211,262,332] },
                { name: "Прочность пехоты (чудо) III", costs: [16,34,57,82,111,149,204,264,327,414] },
                { name: "Прочность стрелков (чудо) III", costs: [16,34,57,82,111,149,204,264,327,414] },
                { name: "Прочность кавалерии (чудо) III", costs: [16,34,57,82,111,149,204,264,327,414] },
                { name: "Наступление пехоты (чудо) III", costs: [19,42,70,100,136,184,250,324,402,509] },
                { name: "Наступление стрелков (чудо) III", costs: [19,42,70,100,136,184,250,324,402,509] },
                { name: "Наступление кавалерии (чудо) III", costs: [19,42,70,100,136,184,250,324,402,509] },
                { name: "Защита пехоты (чудо) III", costs: [23,51,84,121,165,222,302,392,486,615] },
                { name: "Защита стрелков (чудо) III", costs: [23,51,84,121,165,222,302,392,486,615] },
                { name: "Защита кавалерии (чудо) III", costs: [23,51,84,121,165,222,302,392,486,615] },
                { name: "Проклятие Защ пехоты (чудо)", costs: [32,43,55,74,106,158,264,474,885,1580] },
                { name: "Проклятие Защ стрелков (чудо)", costs: [32,43,55,74,106,158,264,474,885,1580] },
                { name: "Проклятие Защ кавалерии (чудо)", costs: [32,43,55,74,106,158,264,474,885,1580] },
                { name: "Проклятие Оз пехоты (чудо)", costs: [42,55,72,96,137,206,343,617,1150,2054] },
                { name: "Проклятие Оз стрелков (чудо)", costs: [42,55,72,96,137,206,343,617,1150,2054] },
                { name: "Проклятие Оз кавалерии (чудо)", costs: [42,55,72,96,137,206,343,617,1150,2054] },
                { name: "Проклятие Атк пехоты (чудо)", costs: [54,72,94,126,180,269,448,806,1504,2686] },
                { name: "Проклятие Атк стрелков (чудо)", costs: [54,72,94,126,180,269,448,806,1504,2686] },
                { name: "Проклятие Атк кавалерии (чудо)", costs: [54,72,94,126,180,269,448,806,1504,2686] }
            ],
            countertypes: [
                { name: "Усиление пехоты против стрелков", costs: [17,39,64,92,125,169,230,298,370,468] },
                { name: "Усиление стрелков против кавалерии", costs: [17,39,64,92,125,169,230,298,370,468] },
                { name: "Усиление кавалерии против пехоты", costs: [17,39,64,92,125,169,230,298,370,468] }
            ]
        };

        let progress = {};

        // Загрузка при старте
        window.onload = function() {
            loadProgress();
            showBranch('familiars');
            
            // Обработчик выбора ветки
            document.getElementById('branchSelect').addEventListener('change', function() {
                showBranch(this.value);
            });
        };

        // Показать ветку исследований
        function showBranch(branch) {
            const researchList = document.getElementById('researchList');
            researchList.innerHTML = '';
            
            researchData[branch].forEach((research, index) => {
                const researchId = ${branch}_${index};
                const currentProgress = progress[researchId] || 0;
                const remaining = calculateRemaining(research.costs, currentProgress);
                
                const item = document.createElement('div');
                item.className = 'research-item';
                item.innerHTML = `
                    <div class="research-name">${research.name}</div>
                    <input type="number" min="0" max="10" value="${currentProgress}" 
                           class="research-input" 
                           onchange="updateProgress('${researchId}', this.value)">
                    <div class="research-remaining">${remaining}</div>
                `;
                researchList.appendChild(item);
            });
            
            updateTotal(branch);
        }

        // Расчет остатка фолиантов
        function calculateRemaining(costs, currentProgress) {
            if (currentProgress >= 10) return 0;
            let remaining = 0;
            for (let i = currentProgress; i < 10; i++) {
                remaining += costs[i];
            }
            return remaining;
        }

        // Обновление прогресса
        function updateProgress(researchId, value) {
            value = Math.min(10, Math.max(0, parseInt(value) || 0));
            progress[researchId] = value;
            
            // Обновляем отображение
            const branch = document.getElementById('branchSelect').value;
            showBranch(branch);
            saveProgress();
        }

        // Обновление общей суммы
        function updateTotal(branch) {
            let total = 0;
            researchData[branch].forEach((research, index) => {
                const researchId = ${branch}_${index};
                const currentProgress = progress[researchId] || 0;
                total += calculateRemaining(research.costs, currentProgress);
            });
            document.getElementById('totalAmount').textContent = total;
        }

        // Сохранение прогресса
        function saveProgress() {
            localStorage.setItem('foliantProgress', JSON.stringify(progress));
        }

        // Загрузка прогресса
        function loadProgress() {
            const saved = localStorage.getItem('foliantProgress');
            if (saved) {
                progress = JSON.parse(saved);
            }
        }
    </script>
</body>
</html>
